#include <stdio.h> 
#include <stdlib.h> 
 
/* ================= CIRCULAR QUEUE STRUCTURE ================= */ 
struct CQueue { 
    int *arr; 
    int size; 
    int front; 
    int rear; 
}; 
 
/* ================= PRIORITY QUEUE STRUCTURE (DESIGN B) 
================= 
   - array stores values 
   - smaller value = higher priority 
   - insertion is ordered (ascending) 
   - delete from front 
*/ 
struct PriorityQueue { 
    int *arr; 
    int size; 
    int front; 
    int rear; 
}; 
 
/* ------------------ Circular Queue Functions ------------------ */ 
void initCQueue(struct CQueue *cq, int n) { 
    cq->size = n; 
    cq->arr = (int *)malloc(n * sizeof(int)); 
 
    if (cq->arr == NULL) { 
        printf("Memory allocation failed!\n"); 
        exit(0); 
    } 
 
    cq->front = -1; 
    cq->rear = -1; 
} 
 
void enCQueue(struct CQueue *cq, int value) { 
    /* FULL condition */ 
    if ((cq->front == 0 && cq->rear == cq->size - 1) || 
        (cq->rear + 1 == cq->front)) { 
        printf("Circular Queue Overflow\n"); 
        return; 
    } 
 
    /* EMPTY condition */ 
    if (cq->front == -1) { 
        cq->front = cq->rear = 0; 
    } else if (cq->rear == cq->size - 1) { 
        cq->rear = 0; 
    } else { 
        cq->rear++; 
    } 
 
    cq->arr[cq->rear] = value; 
    printf("Inserted %d\n", value); 
} 
 
void deCQueue(struct CQueue *cq) { 
    int value; 
 
    /* EMPTY condition */ 
    if (cq->front == -1) { 
        printf("Circular Queue Underflow\n"); 
        return; 
    } 
 
    value = cq->arr[cq->front]; 
    printf("Deleted %d\n", value); 
 
    /* only one element */ 
    if (cq->front == cq->rear) { 
        cq->front = cq->rear = -1; 
    } else if (cq->front == cq->size - 1) { 
        cq->front = 0; 
    } else { 
        cq->front++; 
    } 
} 
 
void displayCQueue(struct CQueue *cq) { 
    int i; 
 
    if (cq->front == -1) { 
        printf("Circular Queue is EMPTY\n"); 
        return; 
    } 
 
    printf("Circular Queue elements: "); 
 
    if (cq->front <= cq->rear) { 
        for (i = cq->front; i <= cq->rear; i++) 
            printf("%d ", cq->arr[i]); 
    } else { 
        for (i = cq->front; i < cq->size; i++) 
            printf("%d ", cq->arr[i]); 
        for (i = 0; i <= cq->rear; i++) 
            printf("%d ", cq->arr[i]); 
    } 
 
    printf("\n"); 
} 
 
/* ------------------ Priority Queue Functions (Design B - Notebook Style) ------------------ */ 
void initPQueue(struct PriorityQueue *pq, int n) { 
    pq->size = n; 
    pq->arr = (int *)malloc(n * sizeof(int)); 
 
    if (pq->arr == NULL) { 
        printf("Memory allocation failed!\n"); 
        exit(0); 
    } 
 
    pq->front = -1; 
    pq->rear = -1; 
} 
 
/* Insert in sorted order (ascending) */ 
void insertPQ(struct PriorityQueue *pq, int value) { 
    int i; 
 
    if (pq->rear == pq->size - 1) { 
        printf("Priority Queue Overflow\n"); 
        return; 
    } 
 
    if (pq->front == -1) { 
        pq->front = pq->rear = 0; 
        pq->arr[pq->rear] = value; 
    } else { 
        for (i = pq->rear; i >= pq->front && pq->arr[i] > value; i--) { 
            pq->arr[i + 1] = pq->arr[i]; 
        } 
 
        pq->arr[i + 1] = value; 
        pq->rear++; 
    } 
 
    printf("Inserted %d\n", value); 
} 
 
/* Delete always from front */ 
void deletePQ(struct PriorityQueue *pq) { 
    if (pq->front == -1) { 
        printf("Priority Queue Underflow\n"); 
        return; 
    } 
 
    printf("Deleted %d\n", pq->arr[pq->front]); 
 
    if (pq->front == pq->rear) { 
        pq->front = pq->rear = -1; 
    } else { 
        pq->front++; 
    } 
} 
 
void displayPQ(struct PriorityQueue *pq) { 
    int i; 
 
    if (pq->front == -1) { 
        printf("Priority Queue is EMPTY\n"); 
        return; 
    } 
 
    printf("Priority Queue elements: "); 
    for (i = pq->front; i <= pq->rear; i++) { 
        printf("%d ", pq->arr[i]); 
    } 
    printf("\n"); 
} 
 
/* ================= MAIN PROGRAM (while + switch like notebook) 
================= */ 
int main() { 
    struct CQueue cq; 
    struct PriorityQueue pq; 
 
    int mainchoice, choice; 
    int n, value; 
 
    printf("Enter size of Queues: "); 
    scanf("%d", &n); 
 
    initCQueue(&cq, n); 
    initPQueue(&pq, n); 
 
    while (1) { 
        printf("\n----- MAIN MENU -----\n"); 
        printf("1. Circular Queue\n"); 
        printf("2. Priority Queue (Design B)\n"); 
        printf("3. Exit Program\n"); 
        printf("\nEnter choice: "); 
        scanf("%d", &mainchoice); 
 
        switch (mainchoice) { 
 
            /* ========== Circular Queue Menu ========== */ 
            case 1: 
                printf("\n--- CIRCULAR QUEUE OPERATIONS ---\n"); 
                printf("1. Enqueue\n"); 
                printf("2. Dequeue\n"); 
                printf("3. Display\n"); 
                printf("4. Back to Main Menu\n"); 
 
                while (1) { 
                    printf("\nEnter choice: "); 
                    scanf("%d", &choice); 
 
                    if (choice == 4) 
                        break; 
 
                    switch (choice) { 
                        case 1: 
                            printf("Enter value: "); 
                            scanf("%d", &value); 
                            enCQueue(&cq, value); 
                            break; 
 
                        case 2: 
                            deCQueue(&cq); 
                            break; 
 
                        case 3: 
                            displayCQueue(&cq); 
                            break; 
 
                        default: 
                            printf("Invalid choice!\n"); 
                    } 
                } 
                break; 
 
            /* ========== Priority Queue Menu (Design B) ========== */ 
            case 2: 
                printf("\n--- PRIORITY QUEUE OPERATIONS (DESIGN B) ---\n"); 
                printf("1. Insert\n"); 
                printf("2. Delete (Highest Priority)\n"); 
                printf("3. Display\n"); 
                printf("4. Back to Main Menu\n"); 
 
                while (1) { 
                    printf("\nEnter choice: "); 
                    scanf("%d", &choice); 
 
                    if (choice == 4) 
                        break; 
 
                    switch (choice) { 
                        case 1: 
                            printf("Enter value (smaller value = higher priority): "); 
                            scanf("%d", &value); 
                            insertPQ(&pq, value); 
                            break; 
 
                        case 2: 
                            deletePQ(&pq); 
                            break; 
 
                        case 3: 
                            displayPQ(&pq); 
                            break; 
 
                        default: 
                            printf("Invalid choice!\n"); 
                    } 
                } 
                break; 
 
            case 3: 
                free(cq.arr); 
                free(pq.arr); 
                printf("Program terminated.\n"); 
                exit(0); 
 
            default: 
                printf("Invalid main menu choice!\n"); 
        } 
    } 
 
    return 0; 
}
