#include <stdio.h> 
#include <stdlib.h> 
 
/* -------- Ordinary Queue Structure -------- */ 
struct Queue { 
    int *arr; 
    int size; 
    int front; 
    int rear; 
}; 
 
/* -------- Deque Structure -------- */ 
struct Deque { 
    int *arr; 
    int size; 
    int front; 
    int rear; 
}; 
 
/* ================= Ordinary Queue Functions (Linear) ================= */ 
 
void initQueue(struct Queue *q, int n) { 
    q->size = n; 
    q->arr = (int *)malloc(n * sizeof(int)); 
    if (q->arr == NULL) { 
        printf("Memory allocation failed!\n"); 
        exit(0); 
    } 
    q->front = -1; 
    q->rear = -1; 
} 
 
void enqueue(struct Queue *q, int value) { 
    if (q->rear == q->size - 1) { 
        printf("Queue Overflow\n"); 
        return; 
    } 
 
    if (q->front == -1) 
        q->front = 0; 
 
    q->rear++; 
    q->arr[q->rear] = value; 
 
    printf("Inserted %d\n", value); 
} 
 
void dequeue(struct Queue *q) { 
    if (q->front == -1 || q->front > q->rear) { 
        printf("Queue Underflow\n"); 
        return; 
    } 
 
    printf("Deleted %d\n", q->arr[q->front]); 
    q->front++; 
 
    if (q->front > q->rear) { // reset when empty 
        q->front = -1; 
        q->rear = -1; 
    } 
} 
 
void peekQueue(struct Queue *q) { 
    if (q->front == -1 || q->front > q->rear) { 
        printf("Queue is EMPTY\n"); 
        return; 
    } 
    printf("Front element: %d\n", q->arr[q->front]); 
} 
 
void displayQueue(struct Queue *q) { 
    int i; 
    if (q->front == -1 || q->front > q->rear) { 
        printf("Queue is EMPTY\n"); 
        return; 
    } 
 
    printf("Queue elements: "); 
    for (i = q->front; i <= q->rear; i++) { 
        printf("%d ", q->arr[i]); 
    } 
    printf("\n"); 
} 
 
/* ================= DEQUE Functions (Linear) ================= */ 
/* EXACTLY based on your notebook logic */ 
 
void initDeque(struct Deque *dq, int n) { 
    dq->size = n; 
    dq->arr = (int *)malloc(n * sizeof(int)); 
    if (dq->arr == NULL) { 
        printf("Memory allocation failed!\n"); 
        exit(0); 
    } 
    dq->front = -1; 
    dq->rear = -1; 
} 
 
void insertFront(struct Deque *dq, int value) { 
    if (dq->front == 0) { 
        printf("Deque Overflow (Front Full)\n"); 
        return; 
    } 
 
    if (dq->front == -1) { 
        dq->front = dq->rear = 0; 
    } else { 
        dq->front--; 
    } 
 
    dq->arr[dq->front] = value; 
    printf("Inserted %d at front\n", value); 
} 
 
void insertRear(struct Deque *dq, int value) { 
    if (dq->rear == dq->size - 1) { 
        printf("Deque Overflow (Rear Full)\n"); 
        return; 
    } 
 
    if (dq->front == -1) { 
        dq->front = dq->rear = 0; 
    } else { 
        dq->rear++; 
    } 
 
    dq->arr[dq->rear] = value; 
    printf("Inserted %d at rear\n", value); 
} 
 
void deleteFront(struct Deque *dq) { 
    if (dq->front == -1) { 
        printf("Deque Underflow\n"); 
        return; 
    } 
 
    printf("Deleted %d from front\n", dq->arr[dq->front]); 
 
    if (dq->front == dq->rear) { 
        dq->front = dq->rear = -1; 
    } else { 
        dq->front++; 
    } 
} 
 
void deleteRear(struct Deque *dq) { 
    if (dq->front == -1) { 
        printf("Deque Underflow\n"); 
        return; 
    } 
 
    printf("Deleted %d from rear\n", dq->arr[dq->rear]); 
 
    if (dq->front == dq->rear) { 
        dq->front = dq->rear = -1; 
    } else { 
        dq->rear--; 
    } 
} 
 
void displayDeque(struct Deque *dq) { 
    int i; 
    if (dq->front == -1) { 
        printf("Deque is EMPTY\n"); 
        return; 
    } 
 
    printf("Deque elements: "); 
    for (i = dq->front; i <= dq->rear; i++) { 
        printf("%d ", dq->arr[i]); 
    } 
    printf("\n"); 
} 
 
/* ================= MAIN (Menu Driven using while + switch exactly like notebook) 
================= */ 
 
int main() { 
    struct Queue q; 
    struct Deque dq; 
 
    int mainchoice, choice, value, n; 
 
    printf("Enter size of Queue and Deque: "); 
    scanf("%d", &n); 
 
    initQueue(&q, n); 
    initDeque(&dq, n); 
 
    while (1) { 
        printf("\n----- MAIN MENU -----\n"); 
        printf("1. Ordinary Queue\n"); 
        printf("2. Double Ended Queue\n"); 
        printf("3. Exit Program\n"); 
 
        printf("\nEnter choice: "); 
        scanf("%d", &mainchoice); 
 
        switch (mainchoice) { 
 
            /* ========== Ordinary Queue Menu ========== */ 
            case 1: 
                printf("\n--- ORDINARY QUEUE OPERATIONS ---\n"); 
                printf("1. Enqueue\n"); 
                printf("2. Dequeue\n"); 
                printf("3. Peek\n"); 
                printf("4. Display\n"); 
                printf("5. Back to Main Menu\n"); 
 
                while (1) { 
                    printf("\nEnter choice: "); 
                    scanf("%d", &choice); 
 
                    if (choice == 5) 
                        break; 
 
                    switch (choice) { 
                        case 1: 
                            printf("Enter value: "); 
                            scanf("%d", &value); 
                            enqueue(&q, value); 
                            break; 
 
                        case 2: 
                            dequeue(&q); 
                            break; 
 
                        case 3: 
                            peekQueue(&q); 
                            break; 
 
                        case 4: 
                            displayQueue(&q); 
                            break; 
 
                        default: 
                            printf("Invalid choice!\n"); 
                    } 
                } 
                break; 
 
            /* ========== DEQUE Menu ========== */ 
            case 2: 
                printf("\n--- DEQUE OPERATIONS ---\n"); 
                printf("1. Insert Front\n"); 
                printf("2. Insert Rear\n"); 
                printf("3. Delete Front\n"); 
                printf("4. Delete Rear\n"); 
                printf("5. Display\n"); 
                printf("6. Back to Main Menu\n"); 
 
                while (1) { 
                    printf("\nEnter choice: "); 
                    scanf("%d", &choice); 
 
                    if (choice == 6) 
                        break; 
 
                    switch (choice) { 
                        case 1: 
                            printf("Enter value: "); 
                            scanf("%d", &value); 
                            insertFront(&dq, value); 
                            break; 
 
                        case 2: 
                            printf("Enter value: "); 
                            scanf("%d", &value); 
                            insertRear(&dq, value); 
                            break; 
 
                        case 3: 
                            deleteFront(&dq); 
                            break; 
 
                        case 4: 
                            deleteRear(&dq); 
                            break; 
 
                        case 5: 
                            displayDeque(&dq); 
                            break; 
 
                        default: 
                            printf("Invalid choice!\n"); 
                    } 
                } 
                break; 
 
            case 3: 
                free(q.arr); 
                free(dq.arr); 
                printf("Program terminated.\n"); 
                exit(0); 
 
            default: 
                printf("Invalid main menu choice!\n"); 
        } 
    } 
 
    return 0; 
} 
