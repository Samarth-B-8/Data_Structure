#include <stdio.h>
#include <stdlib.h>
struct node {
 int data;
 struct node *prev;
 struct node *next;
};
struct node *header;
/* Create header node */
void init() {
 header = (struct node *)malloc(sizeof(struct node));
 header->data = 0;
 header->next = header;
 header->prev = header;
}
/* Display list */
void display() {
 struct node *temp = header->next;
 if (temp == header) {
 printf("List is empty\n");
 return;
 }
 while (temp != header) {
 printf("%d ", temp->data);
 temp = temp->next;
 }
 printf("\n");
}
/* Insert in sorted order */
void insertByOrder(int value) {
 struct node *newnode = (struct node *)malloc(sizeof(struct node));
 struct node *temp = header->next;
 newnode->data = value;
 while (temp != header && temp->data < value) {
 temp = temp->next;
 }
 newnode->next = temp;
 newnode->prev = temp->prev;
 temp->prev->next = newnode;
 temp->prev = newnode;
 display();
}
/* Delete by position */
void deleteByPosition(int pos) {
 struct node *temp = header->next;
 int count = 1;
 if (temp == header) {
 printf("List is empty\n");
 return;
 }
 while (temp != header && count < pos) {
 temp = temp->next;
 count++;
 }
 if (temp == header) {
 printf("Invalid position\n");
 return;
 }
 temp->prev->next = temp->next;
 temp->next->prev = temp->prev;
 free(temp);
 display();
}
/* Delete by key */
void deleteByKey(int key) {
 struct node *temp = header->next;
 if (temp == header) {
 printf("List is empty\n");
 return;
 }
 while (temp != header && temp->data != key) {
 temp = temp->next;
 }
 if (temp == header) {
 printf("Key not found\n");
 return;
 }
 temp->prev->next = temp->next;
 temp->next->prev = temp->prev;
 free(temp);
 display();
}
/* Search by position */
void searchByPosition(int pos) {
 struct node *temp = header->next;
 int count = 1;
 while (temp != header && count < pos) {
 temp = temp->next;
 count++;
 }
 if (temp == header) {
 printf("Invalid position\n");
 } else {
 printf("Element at position %d is %d\n", pos, temp->data);
 }
}
int main() {
 int choice, value, pos;
 init();
 /* Menu printed only once */
 printf("1 Insert by order\n");
 printf("2 Delete by position\n");
 printf("3 Delete by key\n");
 printf("4 Search by position\n");
 printf("5 Exit\n");
 while (1) {
 printf("Enter your choice: ");
 scanf("%d", &choice);
 switch (choice) {
 case 1:
 printf("Enter value: ");
 scanf("%d", &value);
 insertByOrder(value);
 break;
 case 2:
 printf("Enter position: ");
 scanf("%d", &pos);
 deleteByPosition(pos);
 break;
 case 3:
 printf("Enter key: ");
 scanf("%d", &value);
 deleteByKey(value);
 break;
 case 4:
 printf("Enter position: ");
 scanf("%d", &pos);
 searchByPosition(pos);
 break;
 case 5:
 return 0;
 }
 }
}
